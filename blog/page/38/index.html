
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Good good study, day day up</title>
  <meta name="author" content="Leo Liang">

  
  <meta name="description" content="Yesterday, I discussed with Alex whether “delete this” in C++ is legal code. In some case, only the object itself knows when its life is to the end &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aleung.github.com/blog/blog/page/38/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="alternate" title="Good good study, day day up" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2827715-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Good good study, day day up</a></h1>
  
    <h2>aleung的学习笔记, aleung的idea</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aleung.github.com/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2005/02/18/Member-function-call-delete-this-legal/">成员函数调用delete This合法吗？</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-02-18T21:18:00+08:00" pubdate data-updated="true">2005-02-18</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday, I discussed with Alex whether “delete this” in C++ is legal code.</p>

<p>In some case, only the object itself knows when its life is to the end and should be destroyed, the owner of object doesn’t know it, or the object has no explicit owner. The most easy way to manger the life time of this kind of object is let it delete itself.</p>

<p>But we doubted that “delete this” isn’t legal in C++: after the object is released, how does the execution continue?</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="c++"><span class="line"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span><span class="line"><span class="k">public</span><span class="o">:</span>
</span><span class="line"><span class="err"> </span> <span class="kt">void</span> <span class="n">foo</span><span class="p">();</span>
</span><span class="line"><span class="p">};</span>
</span><span class="line">
</span><span class="line"><span class="kt">void</span> <span class="n">A</span><span class="o">::</span><span class="n">foo</span><span class="p">()</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line"><span class="err"> </span> <span class="c1">// do something  </span>
</span><span class="line"><span class="err"> </span> <span class="k">delete</span> <span class="k">this</span><span class="p">;</span>
</span><span class="line"><span class="err"> </span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;I commit suicide!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line"><span class="err"> </span> <span class="n">A</span><span class="o">*</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="p">;</span>
</span><span class="line"><span class="err"> </span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">foo</span><span class="p">();</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I find the answer now, it’s legal, but must be careful when using it. </p>

<p>The following <a href="http://www.sunistudio.com/cppfaq/freestore-mgmt.html#[16.14]">faq</a> explain it clearly:</p>

<blockquote>
  <p>只要你小心，一个对象请求自杀(<code>delete</code> <code>this</code>).是可以的。</p>

  <p>以下是我对“小心”的定义：</p>

  <ol>
    <li>你必须100%的确定，<code>this</code>对象是用 <code>new</code>分配的（不是用<code>new[]</code>，也不是用<a href="http://www.sunistudio.com/cppfaq/dtors.html#[11.10]">定位放置 <code>new</code></a>，也不是一个栈上的局部对象，也不是全局的，也不是另一个对象的成员，而是明白的普通的<code>new</code>）。</li>
    <li>你必须100%的确定，该成员函数是<code>this</code>对象最后调用的的成员函数。</li>
    <li>你必须100%的确定，剩下的成员函数（<code>delete</code> <code>this</code>之后的）不接触到 <code>this</code>对象任何一块（包括调用任何其他成员函数或访问任何数据成员）。</li>
    <li>你必须 100%的确定，在<code>delete</code> <code>this</code>之后不再去访问<code>this</code>指针。换句话说，你不能去检查它，将它和其他指针比较，和 <code>NULL</code>比较，打印它，转换它，对它做任何事。</li>
  </ol>

  <p>自然，对于这种情况还要习惯性地告诫：当你的指针是一个指向基类类型的指针，而没有<a href="http://www.sunistudio.com/cppfaq/virtual-functions.html#[20.4]">虚析构函数</a>时（也不可以 <code>delete</code> <code>this</code>）。 </p>
</blockquote>

<p>And these ariticles also take about “delete this”:</p>

<p><a href="http://info.tlw.cn/6079.htm">http://info.tlw.cn/6079.htm</a><br />
<a href="http://blog.csdn.net/foxmail/archive/2004/09/22/113060.aspx">http://blog.csdn.net/foxmail/archive/2004/09/22/113060.aspx</a></p>
</div>
  
  
  
    <footer>
        <a href="/blog/2005/02/18/Member-function-call-delete-this-legal/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/22/Updated-the-RSS/">更新了RSS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-22T22:05:00+08:00" pubdate data-updated="true">2004-12-22</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/blogging/'>Blogging</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>将blog的rss feed改了一下，使用了<a href="http://www.feedburner.com/">FeedBurner</a>提供的rss扩展服务。大家可以留意页面右下角的rss图标。<strong><em>如果是用RSS Reader阅读我的blog的朋友，麻烦更换一下地址吧</em></strong>。</p>

<p>FeedBurner提供的功能不错的，我只使用了其中的一部分，其中比较特别的就是自动将del.icio.us的书签加入到blog rss中。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2004/12/22/Updated-the-RSS/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/22/The-era-of-network-reading/">网络时代的阅读</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-22T21:32:00+08:00" pubdate data-updated="true">2004-12-22</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/idea/'>Idea</a>, <a class='tag' href='/blog/tags/reading/'>Reading</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>跟同事聊天，说起学生时代读过的书，个个都如数家珍，罗列出一大堆印象深刻的。可那都是很久以前的事情了，要说到近年来看了什么书，几乎都想不起来。报纸上也报道说，根据调查现在的青年的读书比起以前少了多少个百分点。是啊，捧一本书，安坐一角，细细品味，这样的情景已经很久没有出现了。这并不能完全归咎于工作忙碌，没有时间，而是很多空余时间已经被网络占有了。</p>

<p>要说阅读量，现今比起以前倒不见得真的少了，每天在网上浏览，一两个月下来，累计数量估计也比得上一本大部头。只不过，在网上的阅读是很零散的，不如读书一般系统连贯。网上阅读的优势是信息及时，查找方便，可以进行充分的交互沟通；但是网上阅读不足之处是，信息量太大，需要耗费不少时间进行过滤，往往有广度而缺乏深度，可信度也需要靠自己辨别。</p>

<p>看来，网络阅读适合于用来开拓知识面，快速入门，交流讨论；但要想好好学点东西，还是要心平气和，少上网，多读书。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2004/12/22/The-era-of-network-reading/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/13/String-fuzzy-matching/">字符串模糊匹配</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-13T17:35:00+08:00" pubdate data-updated="true">2004-12-13</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>字符串匹配最常用的是正则表达式，但是正则表达式的匹配非常严格，某些场合下，希望的匹配算法是模糊的，只要求找出相似的字符串而不是完全匹配的字符串，例如拼写错误、插入空格等情况。<a href="http://www.codeproject.com/aspnet/intelligent404page.asp">http://www.codeproject.com/aspnet/intelligent404page.asp</a>这篇文章介绍了如何生成智能的404页面，当URL不存在时可提示出拼写近似的网页。其中使用Levenshtein的算法来计算两个字符串的‘edit distance’,也就是一个字符串要经过多少步修改（增加、改变、删除字符），才能变成另外一个字符串。根据计算出的相似的分值，据此来给出建议结果。</p>

<p>这个算法看来在处理用户输入的时候会很有用，能够增加用户界面的人性化程度。一个友善的提示，比起冷冰冰的“输入错误”友好多了，降低了用户使用软件时的心理阻碍。另外，这个算法应该也是可以适用于中文的，采用unicode处理就可以了。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2004/12/13/String-fuzzy-matching/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/11/Relaxed-and-desktop/">清爽的桌面</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-11T02:37:00+08:00" pubdate data-updated="true">2004-12-11</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/software/'>Software</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>一直以为explorer是与windows结合得很紧密的程序，不可缺少。因为它是windows的shell，桌面、菜单、文件浏览窗口都是由它拥有的，如果explorer没有运行，整个屏幕就是空空如也，什么都控制不了。</p>

<p>没有想到，explorer也是可以替换的，<a href="www.geoshell.com">GeoShell</a>就是这样一个explorer的替代品。而且，它是open source的。安装geoshell替换了explorer之后，屏幕界面清爽了很多，可以替换skin，可以安装plugin，最适合那些疯狂的DIYer了，例如可以把系统装扮成MacOS。据说，geoshell占用内存比起explorer要小，稳定性也很不错。我装起来用了半天，确实占内存比explorer少，不过还要用的时间长一点才能确认。</p>

<p><a href="http://www.flickr.com/photos/aleung/2075928/"><img src="http://photos2.flickr.com/2075928_d0c94036cb.jpg" alt="geoshell" /></a></p>
</div>
  
  
  
    <footer>
        <a href="/blog/2004/12/11/Relaxed-and-desktop/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/39/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/37/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Note</h1>
  <p>中国大陆用户可能会因为网络被屏蔽而无法访问本网站或部分内容(文字/图片), 如遇到这种情况, 请翻墙访问</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/23/mi2/">四儿子无望，粗粮也好吧</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/11/my-first-half-marathon/">我的首個半馬拉松</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/06/change-locale-in-android-application/">Android: 在應用中設定locale</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/17/Java-volatile-/">Java的volatile关键字的作用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/15/color-management-2/">色彩管理 (2)</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
<a style="font-size: 137%" href="/blog/tags/android/">Android</a>
<a style="font-size: 114%" href="/blog/tags/anti-gfw/">Anti-GFW</a>
<a style="font-size: 93%" href="/blog/tags/appserver/">AppServer</a>
<a style="font-size: 99%" href="/blog/tags/architecture/">Architecture</a>
<a style="font-size: 70%" href="/blog/tags/artculture/">ArtCulture</a>
<a style="font-size: 116%" href="/blog/tags/blogging/">Blogging</a>
<a style="font-size: 114%" href="/blog/tags/civilsociety/">CivilSociety</a>
<a style="font-size: 108%" href="/blog/tags/diy/">DIY</a>
<a style="font-size: 70%" href="/blog/tags/database/">Database</a>
<a style="font-size: 70%" href="/blog/tags/design/">Design</a>
<a style="font-size: 70%" href="/blog/tags/environmentalprotection/">EnvironmentalProtection</a>
<a style="font-size: 70%" href="/blog/tags/excel/">Excel</a>
<a style="font-size: 99%" href="/blog/tags/funny/">Funny</a>
<a style="font-size: 144%" href="/blog/tags/gps-gis/">GPS_GIS</a>
<a style="font-size: 70%" href="/blog/tags/geek/">Geek</a>
<a style="font-size: 70%" href="/blog/tags/geocaching/">Geocaching</a>
<a style="font-size: 70%" href="/blog/tags/homeappliance/">HomeAppliance</a>
<a style="font-size: 140%" href="/blog/tags/idea/">Idea</a>
<a style="font-size: 111%" href="/blog/tags/imageprocessing/">ImageProcessing</a>
<a style="font-size: 93%" href="/blog/tags/java/">Java</a>
<a style="font-size: 70%" href="/blog/tags/learning/">Learning</a>
<a style="font-size: 108%" href="/blog/tags/life/">Life</a>
<a style="font-size: 85%" href="/blog/tags/maven/">Maven</a>
<a style="font-size: 139%" href="/blog/tags/misc/">Misc</a>
<a style="font-size: 108%" href="/blog/tags/mywork/">MyWork</a>
<a style="font-size: 85%" href="/blog/tags/novel/">Novel</a>
<a style="font-size: 85%" href="/blog/tags/outdoor/">Outdoor</a>
<a style="font-size: 104%" href="/blog/tags/personaldevelopment/">PersonalDevelopment</a>
<a style="font-size: 118%" href="/blog/tags/reading/">Reading</a>
<a style="font-size: 120%" href="/blog/tags/running/">Running</a>
<a style="font-size: 70%" href="/blog/tags/sip/">SIP</a>
<a style="font-size: 137%" href="/blog/tags/software/">Software</a>
<a style="font-size: 160%" href="/blog/tags/softwaredev/">SoftwareDev</a>
<a style="font-size: 93%" href="/blog/tags/springframework/">SpringFramework</a>
<a style="font-size: 126%" href="/blog/tags/sysadmin/">SysAdmin</a>
<a style="font-size: 120%" href="/blog/tags/timemanagement/">TimeManagement</a>
<a style="font-size: 85%" href="/blog/tags/ux/">UX</a>
<a style="font-size: 108%" href="/blog/tags/web/">Web</a>
<a style="font-size: 99%" href="/blog/tags/weblogic/">WebLogic</a>
<a style="font-size: 70%" href="/blog/tags/i18n/">i18n</a>

  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Leo Liang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'aleung';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

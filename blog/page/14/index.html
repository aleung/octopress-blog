
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Good good study, day day up</title>
  <meta name="author" content="Leo Liang">

  
  <meta name="description" content="现在已经有好些智能手机应用可以用来帮助追踪丢失了的手机。有些是当插入不同的SIM卡时触发跟踪，有些是在网络上触发跟踪。我想到另外一个方法：每当手机打开屏幕离开休眠状态时，前置摄像头自动拍摄一幅图像，对画面中的人面进行识别，如果判断不是机主，就将图像上传服务器，并且开启定位跟踪，不断将轨迹上传。这样 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aleung.github.io/blog/blog/page/14/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="alternate" title="Good good study, day day up" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2827715-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Good good study, day day up</a></h1>
  
    <h2>aleung的学习笔记, aleung的idea</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aleung.github.io/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/12/21/Tracking-lost-cell-phone/">追踪丢失了的手机</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-21T17:21:00+08:00" pubdate data-updated="true">2010-12-21</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/idea/'>Idea</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>现在已经有好些智能手机应用可以用来帮助追踪丢失了的手机。有些是当插入不同的SIM卡时触发跟踪，有些是在网络上触发跟踪。我想到另外一个方法：每当手机打开屏幕离开休眠状态时，前置摄像头自动拍摄一幅图像，对画面中的人面进行识别，如果判断不是机主，就将图像上传服务器，并且开启定位跟踪，不断将轨迹上传。这样，不但可以知道手机在哪里，还获得了拿着手机的人的相貌，因为一般人打开手机的时候都是拿在手上，正好前置摄像头就可以拍下面部照片了。</p>

<p>Answer to questions:</p>

<ul>
  <li><em>只有前面有摄像头的手机才能支持这个功能？</em></li>
</ul>

<p>没有前置摄像头的手机不能用，这也是这个idea区别于已有应用的唯一区别。有前置摄像头的智能手机会越来越多的，iPhone推facetime， Android下个版本也会在GTalk里支持视频聊天，硬件肯定要跟上。</p>

<ul>
  <li><em>朋友用了这个功能的手机怎么办？</em></li>
</ul>

<p>机主看到是认识的人，忽略就是啦；如果想做得更少打扰用户，可以让应用在重新”见到”机主时关闭跟踪，见下。</p>

<ul>
  <li><em>检测到其他人用手机之后，这个人是否可以关闭定位功能？</em></li>
</ul>

<p>手机上不能手动关闭，否则就没用了；机主可以通过远程手段关闭；也可以通过面部识别，在重新识别到机主使用手机的时候自动关闭。</p>

<ul>
  <li><em>即使定位到一定范围了，但还不能确认是谁。是否可以与”其他人”打电话协商？</em></li>
</ul>

<p>这个应用是可以控制手机上的所有功能的（如果手机OS允许），因此可以加很多东西，除了定位之外，可以记录通话信息、短信记录、自动发送短信、后台录音等等。但具体还要看OS，例如iOS在不越狱的情况下能做的事情就非常少，Android上有些操作也需要取得root权限才能做。如果这个应用由手机厂商内置进系统里，权限就不是问题了。</p>

<ul>
  <li><em>调用摄像头拍照，通常是没办法影藏的吧，也就是拿着手机的人会知道这种动作</em></li>
</ul>

<p>我不知道现在常用的手机OS是否支持拍照时不在屏幕上显示，摄像头拍照与屏幕显示并没有联系，只是一般情况下都需要实时将摄像头的输入在屏幕上输出，给用户反馈而已。记得Android上有个应用就是用来偷拍的。况且这只是一个idea，真想做或许要对系统做一些调整的。</p>

<ul>
  <li><em>拍得图像亮度，对比度，分辨率差异巨大，在手持设备上进行人脸识别，判断机主，这个实现难度很大。</em></li>
</ul>

<p>拍摄的时候，亮度、对比度是能够调节的，在环境光线不太恶劣的情况下（大逆光、光线暗就没办法了），获得合适对比度的影像是很简单的事情。人脸识别的算法我没有了解，但有<a href="http://hubpages.com/hub/Kodak-Z981-can-automatically-recognize-the-faces-of-20-specific-individuals">数码相机都内置这个功能</a>了，已经不是很难实现的东西了吧？要说处理能力，现在手机的CPU都上1GHz了。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2010/12/21/Tracking-lost-cell-phone/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/12/16/Android-activity-lifecycle-in-UML-state-machine-diagram/">Android Activity Lifecycle in UML State Machine Diagram</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-16T06:25:00+08:00" pubdate data-updated="true">2010-12-16</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/android/'>Android</a>, <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>Lifecycle of Android activity is always confusing beginners. The <code>Activity</code> class has defined dozens of callback functions, all begin with “on”. Some of them are triggered by UI events, some are lifecycle related. It isn’t easy for developer to remember the usage of them.</p>

<p>An activity has essentially four states, when some event happens, like user navigates between different activities, state transites. There are lots of callback functions which will be called by framework when an activity transites between states. So the activity lifecyle is ideally modeled in state machine. However in <a href="http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle">Android SDK document</a>, the Activity Lifecycle is descripted by a diagram and table of callback functions. It explains the order of the callback functions being called, but a developer can’t clearly understand in whatcircumstance each callback function will be called.</p>

<p>I tried to draw an UML state machine diagram for Android activity lifecycle:</p>

<p><a href="http://www.flickr.com/photos/leoliang/5264062473/"><img src="http://farm6.static.flickr.com/5241/5264062473_22989eacb7_b.jpg" alt="Android Activity Lifecycle" /></a></p>

<p>If you aren’t familiar with UML state machine diagram, read the <a href="http://en.wikipedia.org/wiki/UML_state_machine">introduction</a> on Wikipedia.</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2010/12/16/Android-activity-lifecycle-in-UML-state-machine-diagram/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/12/10/Tiny-HTTP-Server-by-Java/">Tiny HTTP Server by Java</a></h1>
    
    
      <p class="meta">
        








  



  
<time datetime="2010-12-10T06:56:00+08:00" pubdate data-updated="true">2010-12-10</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>前两天在项目的测试环境中发现有一个Java实现的 Tiny HTTP server，就一个Java文件，不知道同事从哪里找来的。用来临时从服务器上下载些文件，或者查看HTML文档（例如 JUnit test report, JavaDoc）之类的非常方便。它只支持HTTP GET方法，URL必须指向一个文件。我顺手修改了一下，让它可以列出目录，这样用起来更加方便一些。</p>

<div><script src="https://gist.github.com/1347769.js"></script>
<noscript><pre><code>import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.StringTokenizer;

public class HttpServer {
  public static void main(String args[]) {
    int port;
    try {
      port = Integer.parseInt(args[0]);
    } catch (Exception e) {
      port = 80;
    }

    String root;
    try {
      root = args[1];
    } catch (Exception e) {
      root = &quot;../&quot;;
    }
    
    try {

      ServerSocket server_socket = new ServerSocket(port);
      System.out.println(&quot;HttpServer running on port &quot;
          + server_socket.getLocalPort() + &quot;, root directory is &quot; + root);

      // server infinite loop
      while (true) {
        Socket socket = server_socket.accept();
        System.out.println(&quot;New connection accepted &quot;
            + socket.getInetAddress() + &quot;:&quot; + socket.getPort());

        // Construct handler to process the HTTP request message.
        try {
          HttpRequestHandler request = new HttpRequestHandler(socket, root);
          // Create a new thread to process the request.
          Thread thread = new Thread(request);
          thread.start();
        } catch (Exception e) {
          System.out.println(e);
        }
      }
    } catch (IOException e) {
      System.out.println(e);
    }
  }
}

class HttpRequestHandler implements Runnable {
  final static String CRLF = &quot;\r\n&quot;;

  Socket socket;
  InputStream input;
  OutputStream output;
  BufferedReader br;
  private String root;

  public HttpRequestHandler(Socket socket, String root) throws Exception {
    this.root = root;
    this.socket = socket;
    this.input = socket.getInputStream();
    this.output = socket.getOutputStream();
    this.br = new BufferedReader(new InputStreamReader(socket
        .getInputStream()));
  }

  public void run() {
    try {
      processRequest();
    } catch (Exception e) {
      e.printStackTrace();
    }
  }

  private void processRequest() throws Exception {
    while (true) {
      String headerLine = br.readLine();
      System.out.println(&quot;&gt;&gt;&gt;Request&quot;);
      System.out.println(headerLine);
      if (headerLine.equals(CRLF) || headerLine.equals(&quot;&quot;))
        break;

      StringTokenizer s = new StringTokenizer(headerLine);
      String temp = s.nextToken();

      if (temp.equals(&quot;GET&quot;)) {

        String serverLine = &quot;Server: Simple Java Http Server&quot;;
        String statusLine = null;
        String contentTypeLine = &quot;text/html&quot;;
        String entityBody = null;
        String contentLengthLine = &quot;&quot;;
        FileInputStream fis = null;
        boolean fileExists = false;
      
        String requestedPath = s.nextToken();
        if (requestedPath.equals(&quot;/&quot;)) {
          requestedPath = &quot;&quot;;
        }
        String fileName = root + requestedPath;
        System.out.println(&quot;===Debug&quot;);
        System.out.println(fileName);
        File file = new File(fileName);
        if (!file.exists()) {
          statusLine = &quot;HTTP/1.0 404 Not Found&quot; + CRLF;
          entityBody = &quot;&lt;HTML&gt;&quot;
              + &quot;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&quot;
              + &quot;&lt;BODY&gt;404 Not Found&quot;
              + &quot;&lt;br&gt;usage:http://yourHostName:port/&quot;
              + &quot;fileName.html&lt;/BODY&gt;&lt;/HTML&gt;&quot;;
        } else {
          statusLine = &quot;HTTP/1.0 200 OK&quot; + CRLF;

          if (file.isDirectory()) {
            String[] files = file.list();
            entityBody = &quot;&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;&quot; + file.getPath() 
                + &quot;&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;UL&gt;&quot;;
            for (String entry : files) {
              entityBody += &quot;&lt;LI&gt;&lt;a href='&quot; + requestedPath + &quot;/&quot; + entry + &quot;'&gt;&quot; 
                + entry +&quot;&lt;/a&gt;&lt;/LI&gt;&quot;;
            }
            entityBody += &quot;&lt;/UL&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;;
          } else {
            try {
              fis = new FileInputStream(file);
              fileExists = true;
            } catch (FileNotFoundException e) {
              e.printStackTrace();
            }
            contentTypeLine = &quot;Content-type: &quot; + contentType(fileName) + CRLF;
            contentLengthLine = &quot;Content-Length: &quot;
              + (new Integer(fis.available())).toString() + CRLF;
          }
        }

        if (!fileExists) {
            contentLengthLine = &quot;Content-Length: &quot;
              + (new Integer(entityBody.getBytes().length)).toString() + CRLF;
        }
        
        System.out.println(&quot;&lt;&lt;&lt;Response&quot;);

        output.write(statusLine.getBytes());
        System.out.println(statusLine);
        output.write(serverLine.getBytes());
        System.out.println(serverLine);
        output.write(contentTypeLine.getBytes());
        System.out.println(contentTypeLine);
        output.write(contentLengthLine.getBytes());
        System.out.println(contentLengthLine);

        // Send a blank line to indicate the end of the header lines.
        output.write(CRLF.getBytes());
        System.out.println(CRLF);

        // Send the entity body.
        if (fileExists) {
          sendBytes(fis, output);
          fis.close();
        } else {
          output.write(entityBody.getBytes());
          System.out.println(entityBody);
        }

      }
    }

    try {
      output.close();
      br.close();
      socket.close();
    } catch (Exception e) {
    }
  }

  private static void sendBytes(FileInputStream fis, OutputStream os)
      throws Exception {

    byte[] buffer = new byte[1024];
    int bytes = 0;

    while ((bytes = fis.read(buffer)) != -1) {
      os.write(buffer, 0, bytes);
    }
  }

  private static String contentType(String fileName) {
    if (fileName.endsWith(&quot;.htm&quot;) || fileName.endsWith(&quot;.html&quot;)
        || fileName.endsWith(&quot;.txt&quot;)) {
      return &quot;text/html&quot;;
    } else if (fileName.endsWith(&quot;.jpg&quot;) || fileName.endsWith(&quot;.jpeg&quot;)) {
      return &quot;image/jpeg&quot;;
    } else if (fileName.endsWith(&quot;.gif&quot;)) {
      return &quot;image/gif&quot;;
    } else {
      return &quot;application/octet-stream&quot;;
    }
  }
}</code></pre></noscript></div>

<p>运行时可带两个参数：port, http root directory。例如:</p>

<pre><code>$JAVA_HOME/bin/java httpServer 8080 /tmp/test-report
</code></pre>

<p>P.S. 网上搜索一下，我的同事应该是从这里找到这段代码的：<a href="http://www.java2s.com/Code/Java/Tiny-Application/HttpServer.htm">http://www.java2s.com/Code/Java/Tiny-Application/HttpServer.htm</a></p>
</div>
  
  
  
    <footer>
        <a href="/blog/2010/12/10/Tiny-HTTP-Server-by-Java/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/11/13/right-of-way/">路权</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-13T07:01:00+08:00" pubdate data-updated="true">2010-11-13</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/civilsociety/'>CivilSociety</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>第一次到荷兰的时候，同行同事就说，荷兰人开车怎么都不让行人啊。住的酒店附近几条路都不宽，也就是广州小区里的道路的宽度，车也不多，路口没有交通灯也没有斑马线，但是我们过马路的时候汽车都不让我们，跟在瑞典受到的礼遇差远了。当时我们就说，看来荷兰人不如瑞典人谦让啊。</p>

<p>但后来呆的时间长了，发现也不全是这样，当在斑马线上要过马路时，即使我们习惯的站在路边等待，即使汽车以很快的速度飙过来，大多数司机都会将车停在斑马线前让我们过去。我就想，也许是刚来的时候定论下得太早了，其实多数荷兰司机也让行人的。</p>

<p>抱着这种”在路口过马路时汽车会让行人”的心态，在一些路口又碰了麻烦。住处的附近有个丁字路口，准备右转的车会停在路口前，我经常趁这个机会就过马路，以为他们是故意让我的。但有时我刚要过马路的时候它又起步了。</p>

<p>后来，我才发现了区别：那个丁字路口虽然用横穿马路的线标示行人自行车横过的路线，但却没有画斑马线。在有斑马线的地方，即使你只是站在路边，多数汽车都会完全停下让你先过；而想在没斑马线的地方过马路就得非常小心，一定要完全没车才能过，汽车不会作丝毫减速避让。这与道路的宽度没有关系，与车辆多少行人多少也没有关系，一切按照标识。习惯了之后就发现这非常好，行人车辆都守规矩，行人不怕被车撞，车辆不担心撞到人，相互都不会影响到对方。</p>

<p>类似的情况也体现在车辆行驶上。在欧洲，坐车离开城市范围后，公路往往都不宽，甚至只有两车道，不时会有分叉路口或者十字路口，都没有交通灯的，但是司机一路都开得很快，不会在路口前减速，仿佛他从来不担心路口会有车驶出来。仔细观察后发现路口前都会有交通标志，用粗线和细线标出交会的道路，我们走的路是粗线，司机是不会减速的，但如果我们走的路是细线，司机就会在路口前减速或者停下来。</p>

<p>在这里面有一个路权（Right of way）的概念非常重要，路权是使用道路的权利。斑马线标志着在这个区域中行人拥有比车辆优先的路权，因此车辆要停下来等行人通行；而在没有斑马线的地方，行人过马路不能影响汽车的通行，因为车辆有优先路权（对此，不同地方的交通法规可能不一样）。在没有交通灯的路口，主要道路上的车辆有优先路权，因此岔道上的车只能在完全不会影响主要道路上车辆通行的时候才能驶出来。有交通灯的路口，绿灯表示得到路权。在路口，直行车辆比左转车辆路权优先，因此左转车不能强行挡住对面来车而左转。</p>

<p>在发达国家（也包括香港、澳门），虽然多数道路都狭窄，平交路口密集且大都不设交通灯，交通依然相当顺畅，道路通行效率很高。这其实并不是什么礼让不礼让的问题，关键是明确每个参与者所拥有的权利，大家相互尊重对方的权利，依照规则行事。我没有考车牌，不知道中国的交通法规里有没有与西方国家相同的路权的概念，不过就算有，在每个人的心中和实际执行中都是不存在的。</p>

<p>由这个路权想开，我觉得西方国家发达，其中一个因素是他们能够很好的将社会中各个个体的关系及利益冲突通过权利（right）来明晰、规范和协调，保障了整个社会运作的效率。而中国人向来缺乏权利意识，也没有对权利的尊重，我们认的只是权力（power）。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2010/11/13/right-of-way/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/11/02/WebLogic-Resource-Adapter-JCA-WorkManager-/">WebLogic在非Resource Adapter里直接使用JCA WorkManager的失败尝试</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-02T05:43:00+08:00" pubdate data-updated="true">2010-11-02</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/appserver/'>AppServer</a>, <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>, <a class='tag' href='/blog/tags/weblogic/'>WebLogic</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>JCA 1.5 规范定义了WorkManager API，能方便的进行任务的(多线程)并行处理。按照JCA规范的原意，WorkManager是仅提供给Resource Adapter使用的，容器会提供WorkManager实例并通过BootstrapContext注入到adapter中。可是，有时在其他场合，例如EJB、Servlet中，也希望能将请求拆分，使用WorkManager并行处理，但JEE规范中并没有提供这样的机制。</p>

<p>WebLogic提供了CommonJ WorkManager API，可用于任意应用中，但这个API不在JEE规范之中，因此GlassFish是不支持的。而且，使用WebLogic CommonJ WorkManager时需要在ejb-jar.xml中加入一个类型为commonj.work.WorkManager的resource reference，这样同一个ejb包就不能在不同application server间通用了，因此我还是希望能找到一种通用的方法。</p>

<p>SpringFramework的org.springframework.jca.work包为GlassFish和JBoss提供了在Resource Adapter外部使用JCA 1.5 WorkManager的简便方法。看了for GlassFish的源代码，发现它其实是调用了GlassFish内部的factory去直接创建WorkManager，那么对GlassFish是否也可以这样做呢？</p>

<p>反编译WebLogic的jar包，发现commonj WorkManager和connector WorkManager实际上都是delegate到一个weblogic.work.WorkManager实现的，也就是说在WebLogic里，CommonJ和JCA的WorkManager的底层实现其实都是同样的。接下来找到了weblogic.work.WorkManagerFactory，它有find和findOrCreate方法可返回weblogic.work.WorkManager实例，也许就是可以拿到weblogic-ejb-jar.xml里面定义的weblogic WorkManager。拿到了内部的weblogic.work.WorkManager实例后，再调用weblogic.connector.work.WorkManager的create方法，将这个内部WorkManger包裹到JCA WorkManager中，那么我们的应用就可以使用这个JCA WorkManager了，通过Spring的WorkManagerTaskExecutor来很方便的调度任务，上层的逻辑就可以做到与应用服务器无关。看起来很美。</p>

<p><a href="http://www.flickr.com/photos/leoliang/5137622842/"><img src="http://farm2.static.flickr.com/1208/5137622842_a9b4e5fda8_b.jpg" alt="WLS-WorkManager" /></a></p>

<p>可是结果是残酷的。写了一个测试程序，结果是通过这个WorkManagerFactory可以成功的获取到weblogic.work.WorkManager实例，也能够创建出包裹的JCA WorkManager，可是真正要使用它来执行work时，它很坚定的拒绝了，抛出异常信息：Attempt to create Work outside the context of the Connector container。</p>

<p>查看代码，发现weblogic.connector.work.WorkManager及WorkImpl内部会寻找相应的RAInstanceManager，并且WorkImpl需要用到rarClassloader，看来它设计上还是与resource adapter相关的。一涉及到classloader，我无心恋战了，算了，就此打住。</p>

<p>P.S. 既然说到WorkManager，就推荐一下我的同事写的相关的一篇blog：<a href="http://www.javaeye.com/topic/623825">application server 下的任务异步/并行执行方案</a></p>

<p>P.P.S. 我后来采用的解决方案是让build system可以根据需要为不同的 target application server 选择不同的 deployment descriptor 来build相应的artifacts。</p>

<p>P.P.P.S. 回头再读一下，发现文章里中文英文混杂得很厉害。没办法了，那些专业术语都是看惯英文了，用中文翻译了反而别扭。</p>
</div>
  
  
  
    <footer>
        <a href="/blog/2010/11/02/WebLogic-Resource-Adapter-JCA-WorkManager-/#disqus_thread">Comments</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/15/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/13/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Note</h1>
  <p>中国大陆用户可能会因为网络被屏蔽而无法访问本网站或部分内容(文字/图片), 如遇到这种情况, 请翻墙访问</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/09/16/smog/">是灰霾吗？</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/23/plantuml/">PlantUML 简介</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/23/getting-the-hang-of-web-typography/">Getting the Hang of Web Typography</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/21/run/">跑步日記</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/03/zhong-guo-di-tu-pian-yi/">中國電子地圖偏移</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
<a style="font-size: 139%" href="/blog/tags/android/">Android</a>
<a style="font-size: 113%" href="/blog/tags/anti-gfw/">Anti-GFW</a>
<a style="font-size: 93%" href="/blog/tags/appserver/">AppServer</a>
<a style="font-size: 99%" href="/blog/tags/architecture/">Architecture</a>
<a style="font-size: 70%" href="/blog/tags/artculture/">ArtCulture</a>
<a style="font-size: 115%" href="/blog/tags/blogging/">Blogging</a>
<a style="font-size: 113%" href="/blog/tags/civilsociety/">CivilSociety</a>
<a style="font-size: 110%" href="/blog/tags/diy/">DIY</a>
<a style="font-size: 70%" href="/blog/tags/datavisualization/">DataVisualization</a>
<a style="font-size: 70%" href="/blog/tags/database/">Database</a>
<a style="font-size: 84%" href="/blog/tags/design/">Design</a>
<a style="font-size: 84%" href="/blog/tags/environmentalprotection/">EnvironmentalProtection</a>
<a style="font-size: 70%" href="/blog/tags/excel/">Excel</a>
<a style="font-size: 84%" href="/blog/tags/funny/">Funny</a>
<a style="font-size: 143%" href="/blog/tags/gps-gis/">GPS_GIS</a>
<a style="font-size: 84%" href="/blog/tags/gadget/">Gadget</a>
<a style="font-size: 70%" href="/blog/tags/geek/">Geek</a>
<a style="font-size: 70%" href="/blog/tags/geocaching/">Geocaching</a>
<a style="font-size: 70%" href="/blog/tags/hardware/">Hardware</a>
<a style="font-size: 70%" href="/blog/tags/homeappliance/">HomeAppliance</a>
<a style="font-size: 139%" href="/blog/tags/idea/">Idea</a>
<a style="font-size: 110%" href="/blog/tags/imageprocessing/">ImageProcessing</a>
<a style="font-size: 93%" href="/blog/tags/java/">Java</a>
<a style="font-size: 70%" href="/blog/tags/learning/">Learning</a>
<a style="font-size: 110%" href="/blog/tags/life/">Life</a>
<a style="font-size: 103%" href="/blog/tags/maven/">Maven</a>
<a style="font-size: 139%" href="/blog/tags/misc/">Misc</a>
<a style="font-size: 107%" href="/blog/tags/mywork/">MyWork</a>
<a style="font-size: 84%" href="/blog/tags/novel/">Novel</a>
<a style="font-size: 84%" href="/blog/tags/outdoor/">Outdoor</a>
<a style="font-size: 103%" href="/blog/tags/personaldevelopment/">PersonalDevelopment</a>
<a style="font-size: 70%" href="/blog/tags/r/">R</a>
<a style="font-size: 119%" href="/blog/tags/reading/">Reading</a>
<a style="font-size: 124%" href="/blog/tags/running/">Running</a>
<a style="font-size: 70%" href="/blog/tags/sip/">SIP</a>
<a style="font-size: 135%" href="/blog/tags/software/">Software</a>
<a style="font-size: 160%" href="/blog/tags/softwaredev/">SoftwareDev</a>
<a style="font-size: 93%" href="/blog/tags/springframework/">SpringFramework</a>
<a style="font-size: 84%" href="/blog/tags/statistics/">Statistics</a>
<a style="font-size: 124%" href="/blog/tags/sysadmin/">SysAdmin</a>
<a style="font-size: 119%" href="/blog/tags/timemanagement/">TimeManagement</a>
<a style="font-size: 84%" href="/blog/tags/uml/">UML</a>
<a style="font-size: 99%" href="/blog/tags/ux/">UX</a>
<a style="font-size: 107%" href="/blog/tags/web/">Web</a>
<a style="font-size: 99%" href="/blog/tags/weblogic/">WebLogic</a>
<a style="font-size: 70%" href="/blog/tags/i18n/">i18n</a>

  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Leo Liang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'aleung';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

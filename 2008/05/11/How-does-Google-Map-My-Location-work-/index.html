
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>How does Google Map My Location work? - Good good study, day day up</title>
  <meta name="author" content="Leo Liang">

  
  <meta name="description" content="在今年初推出的Google Map for Mobile新版本中提供了称为My Location的功能，不需要GPS的支持，也能在地图上显示出当前手机所在的位置。这个功能着实让人眼前一亮。虽然移动网络本身就可以提供定位的能力，但是Google的My Location并不依赖于移动网络定位能力， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aleung.github.com/blog/2008/05/11/How-does-Google-Map-My-Location-work-/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="alternate" title="Good good study, day day up" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2827715-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Good good study, day day up</a></h1>
  
    <h2>aleung的学习笔记, aleung的idea</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aleung.github.com/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">How Does Google Map My Location Work?</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-11T08:22:00+08:00" pubdate data-updated="true">2008-05-11</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/gps-gis/'>GPS_GIS</a>
  
</span>


        
      </p>
    
  </header>


<div class="entry-content"><p>在今年初推出的<a href="http://www.google.com/mobile/gmm/index.html">Google Map for Mobile</a>新版本中提供了称为My Location的功能，不需要GPS的支持，也能在地图上显示出当前手机所在的位置。这个功能着实让人眼前一亮。虽然移动网络本身就可以提供定位的能力，但是Google的My Location并不依赖于移动网络定位能力，完全绕开了运营商的控制。</p>

<p>My Location是怎样实现的呢？Google网站上介绍了大致的<a href="http://www.google.com/mobile/gmm/mylocation/index.html">原理</a>：手机接收到移动基站的信号，根据基站的信息可以知道当前处于哪个基站的信号覆盖范围，如果基站的位置是已知的，就可以确定当前的大概位置了。</p>

<p>具体点说，这是一种叫做Cell-Id Positioning Method的技术。GSM网络（3G网络也一样）覆盖由Location Area组成，（Location Area是指mobile terminal可以任意移动而不需要进行location update的区域）。Location Area由LAI（Location Area Id）来标识，LAI由MCC，MNC，LAC组成。其中MCC是3位的Mobile Country Code，中国为460；MNC是2位Mobile Network Code，在国家内分配，中国移动为00；LAC为Location Area Code，在network内分配；可见LAI是全世界唯一的。在一个location area中设置一个或多个基站，基站天线的信号覆盖一定的区域，称为cell（小区）；根据天线的不同，每个基站可能包含1个或多个cell，定向天线的信号覆盖一个扇形范围，多个天线的扇区为不同的cell。每个cell有自己的Cell-Id，结合LAI和Cell-Id，就可以在全球范围内唯一确定一个cell。要进行定位，需要有一个cell坐标数据库，根据cell-id来查找位置信息。</p>

<p>Google的My Location表示格式为myl:MCC:MNC:LAC:CI。在Google Map for Mobile的about信息末尾可以看到。如果显示为myl:n/a，那就是手机不能提供cell-id信息。很不幸，我正在用的SonyEricsson w810c就不支持:(</p>

<p>下一个问题就是cell坐标数据是怎么来的？移动网络运营商提供，不是太现实。Google不可能与全球所有的运营商达成协议。特别是在中国，凡是涉及精确地理坐标的数据都属于机密范畴，然而我们发现My Location在广州是可用的，估计其他城市也可以。于是我猜Google是自己采集这些信息的，例如开辆车周围转，记录各处的cell-id。但有点奇怪的是，在广州我们发现在天河软件园得到的位置比较准确，但是在其他地方的就误差很大，并且表示精确度范围的圆圈半径非常大，将半个天河区都包含在内。难道Google只在天河软件园采集了数据，而其他地方没有？</p>

<p>最近，一个同事开发了一个程序，利用手机自带的GPS定位，将cell-id与坐标记录下来。我们讨论的时候才恍然大悟，Google很可能就是这样做的！有些Google Map for Mobile用户的手机是支持GPS的，当这些用户运行Google Map时打开了GPS，坐标数据以及cell-id就会发送到Google的服务器，等于有许多用户在替Google采集数据。在天河软件园的定位准确，就因为我们（当然也可能有其他人）在这里试验Google Map时打开过GPS。在我们这里，支持GPS的手机的拥有率不高，同时又使用Google Map的更少，因此Google掌握到的数据很有限。在没有采集到数据的地方，定位就不准确了。</p>

<p>为了求证，到Google网站上查看，在GoogleMobile的Privacy Policy中找到这样一段话：<em>If you use location-based products and services, such as Google Maps for mobile, you may be sending us location information. This information may reveal your actual location, such as GPS data, or it may not, such as when you submit a partial address to look at a map of the area</em>. 在help中又找到一段话：<em>Google takes geo-contextual information [from anonymous GPS-readings, etc] and associates this information with the cell at that location to develop a database of cell locations</em>. 看来我们的猜想是成立的。其实还可以通过做实验来证明：找一台支持GPS的手机，到一个定位有非常大误差的地方，在Google Map中enable GPS。过一段时间后，例如几天，因为Google处理数据可能有延迟，在关闭GPS的状态下看My Location，如果定位变得准确了就是Google使用了用户手机GPS采集的数据。不过我没有GPS手机，无法做这个实验。</p>

<p>在网上查找资料的过程中发现，其实Cell-id定位并不是一项新技术，不过它与Google Map的海量高清晰度地图结合起来，给业界带来了震撼。在Treo智能手机上，2006年就有国内的爱好者开发了<a href="http://www.palm119.net/blogview.asp?logID=42">手机定位软件</a>，根据cell-id查询到当前位置，不过位置信息是地名，而不是经纬度坐标；Cell-Id对照地名信息的数据库是由用户补充完善的。在网上搜索一下，也可以找到好几个开放的cell-id坐标数据库，例如<a href="http://www.opencellid.org/">OpenCellID</a>，只不过几乎都没有中国大陆的数据。Flickr为了配合ZoneTag（用手机拍照时记录下cell-id，从而可以知道照片拍摄的位置），还提供了<a href="http://developer.yahoo.com/yrb/zonetag/locatecell.html">Cell Location API</a>。</p>
</div>


  <footer>
    <p class="meta">
    <!--
      
  

<span class="byline author vcard">Posted by <span class="fn">Leo Liang</span></span>

      








  


<time datetime="2008-05-11T08:22:00+08:00" pubdate data-updated="true">2008-05-11</time>
      


      

<span class="tags">
  
    <a class='tag' href='/blog/tags/gps-gis/'>GPS_GIS</a>
  
</span>


    -->
    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://aleung.github.com/blog/2008/05/11/How-does-Google-Map-My-Location-work-/" data-via="acette" data-counturl="http://aleung.github.com/blog/2008/05/11/How-does-Google-Map-My-Location-work-/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/04/15/Linux-cut-/" title="Previous Post: Linux的cut命令">&laquo; Linux的cut命令</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/05/13/Wenchuan-county-sichuan-M7-8-earthquake-happened/" title="Next Post: 四川汶川县发生M7.8级地震">四川汶川县发生M7.8级地震 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Note</h1>
  <p>中国大陆用户可能会因为网络被屏蔽而无法访问本网站或部分内容(文字/图片), 如遇到这种情况, 请翻墙访问</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/30/mi2-usb-debug-on-osx/">怎样在OSX上adb连接小米2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/23/mi2/">四儿子无望，粗粮也好吧</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/11/my-first-half-marathon/">我的首個半馬拉松</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/06/change-locale-in-android-application/">Android: 在應用中設定locale</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/17/Java-volatile-/">Java的volatile关键字的作用</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
<a style="font-size: 138%" href="/blog/tags/android/">Android</a>
<a style="font-size: 114%" href="/blog/tags/anti-gfw/">Anti-GFW</a>
<a style="font-size: 93%" href="/blog/tags/appserver/">AppServer</a>
<a style="font-size: 99%" href="/blog/tags/architecture/">Architecture</a>
<a style="font-size: 70%" href="/blog/tags/artculture/">ArtCulture</a>
<a style="font-size: 116%" href="/blog/tags/blogging/">Blogging</a>
<a style="font-size: 114%" href="/blog/tags/civilsociety/">CivilSociety</a>
<a style="font-size: 108%" href="/blog/tags/diy/">DIY</a>
<a style="font-size: 70%" href="/blog/tags/database/">Database</a>
<a style="font-size: 70%" href="/blog/tags/design/">Design</a>
<a style="font-size: 70%" href="/blog/tags/environmentalprotection/">EnvironmentalProtection</a>
<a style="font-size: 70%" href="/blog/tags/excel/">Excel</a>
<a style="font-size: 99%" href="/blog/tags/funny/">Funny</a>
<a style="font-size: 144%" href="/blog/tags/gps-gis/">GPS_GIS</a>
<a style="font-size: 70%" href="/blog/tags/geek/">Geek</a>
<a style="font-size: 70%" href="/blog/tags/geocaching/">Geocaching</a>
<a style="font-size: 70%" href="/blog/tags/homeappliance/">HomeAppliance</a>
<a style="font-size: 140%" href="/blog/tags/idea/">Idea</a>
<a style="font-size: 111%" href="/blog/tags/imageprocessing/">ImageProcessing</a>
<a style="font-size: 93%" href="/blog/tags/java/">Java</a>
<a style="font-size: 70%" href="/blog/tags/learning/">Learning</a>
<a style="font-size: 108%" href="/blog/tags/life/">Life</a>
<a style="font-size: 85%" href="/blog/tags/maven/">Maven</a>
<a style="font-size: 139%" href="/blog/tags/misc/">Misc</a>
<a style="font-size: 108%" href="/blog/tags/mywork/">MyWork</a>
<a style="font-size: 85%" href="/blog/tags/novel/">Novel</a>
<a style="font-size: 85%" href="/blog/tags/outdoor/">Outdoor</a>
<a style="font-size: 104%" href="/blog/tags/personaldevelopment/">PersonalDevelopment</a>
<a style="font-size: 118%" href="/blog/tags/reading/">Reading</a>
<a style="font-size: 120%" href="/blog/tags/running/">Running</a>
<a style="font-size: 70%" href="/blog/tags/sip/">SIP</a>
<a style="font-size: 137%" href="/blog/tags/software/">Software</a>
<a style="font-size: 160%" href="/blog/tags/softwaredev/">SoftwareDev</a>
<a style="font-size: 93%" href="/blog/tags/springframework/">SpringFramework</a>
<a style="font-size: 126%" href="/blog/tags/sysadmin/">SysAdmin</a>
<a style="font-size: 120%" href="/blog/tags/timemanagement/">TimeManagement</a>
<a style="font-size: 85%" href="/blog/tags/ux/">UX</a>
<a style="font-size: 108%" href="/blog/tags/web/">Web</a>
<a style="font-size: 99%" href="/blog/tags/weblogic/">WebLogic</a>
<a style="font-size: 70%" href="/blog/tags/i18n/">i18n</a>

  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Leo Liang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'aleung';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://aleung.github.com/blog/2008/05/11/How-does-Google-Map-My-Location-work-/';
        var disqus_url = 'http://aleung.github.com/blog/2008/05/11/How-does-Google-Map-My-Location-work-/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: ImageProcessing | Good good study, day day up]]></title>
  <link href="http://aleung.github.io/blog/tags/imageprocessing/atom.xml" rel="self"/>
  <link href="http://aleung.github.io/blog/"/>
  <updated>2014-03-26T12:18:43+08:00</updated>
  <id>http://aleung.github.io/blog/</id>
  <author>
    <name><![CDATA[Leo Liang]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[色彩管理 (2)]]></title>
    <link href="http://aleung.github.io/blog/2012/09/15/color-management-2/"/>
    <updated>2012-09-15T00:56:00+08:00</updated>
    <id>http://aleung.github.io/blog/2012/09/15/color-management-2</id>
    <content type="html"><![CDATA[<p>色彩管理的<a href="/2004/11/12/Color-management-1">第一篇</a>是在2004年写的，当时本来想连续写，可写了一篇就没有下文了。现在再来继续色彩的话题，不过这次的主题其实不算色彩管理，而是看看色彩的本质是什么。</p>

<p>颜色是什么？学物理的时候说太阳光通过菱镜会分离成彩色的光带，不同颜色的光的波长是不一样的。这给我们一个印象：颜色就是可见光波长这个物理量的反映。但是问题来了，白色对应什么波长的光？为什么红光和绿光混合在一起变成了黄光，难道混合后波长产生变化了？原因在于，颜色并不是某一個物理量的直接反映，而是人对光线的心理反映，称之为色觉。</p>

<p><img class="right" src="/attachments/2012/9/eye.jpg"> </p>

<p>人眼有三种色彩感受器（视锥细胞），每种感受器可以感应不同波长范围的光，分别的感受峰值波长为：420nm，534nm，564nm，差不多相当于蓝、绿、红三色光的波长。对于某一种光谱，三种感受器得到三组信号送往大脑，大脑根据这三组信号值的不同组合感知到不同的色彩。</p>

<p>现实世界中的光线通常都不会是单一波长的（只有激光光源产生的才是单一波长的光吧，要么是经过分光镜得到的），而是不同波长组合的混合光。视觉感受器并不能区分这些光谱，反正各种感受器只对自己能感应的波长范围内的光作出反应，最后大脑拿到的就是三组信号而已。不同的光谱组合的光线，可能对三种视觉感受器产生的刺激恰好是一样的，这样大脑就会将它们感受为同一种颜色，术语称为“异谱同色”。例如波长600nm左右的光线人感受是黄色，而波长540nm绿光和700nm红光一定强度比例的混合，人感觉到的也是黄色。</p>

<p>我曾经在之乎问过一个问题：人眼若多一种新的视椎细胞可感应可见光范围内的另外一个波长的光，人看到的色彩会有什么变化吗？看到的颜色更多？ 后来我想明白了，是会看到更多的颜色的，准确的说，是能够分辨出更多不同的颜色。在只有三种感受器时，有些不同波长组合的混合光产生的刺激是一样的，大脑区分不出，将它们当作同样的颜色，但假若增加另一种波长的感受器后，这个感受器感应到的刺激不同，就能够分辨为不同色彩了。至于这个颜色是什么？我们不可能知道，因为颜色仅仅是一种心理反应。如此类推，不同动物看到的色彩也是不一样的，因为不同动物眼睛的视锥细胞的波长响应曲线不同，而且数量也不一定一样。假如有某种外星人有四种甚至更多的色彩感受器，那他们会认为地球人全是色盲，地球人到他们的世界里可能连分辨交通灯都有问题——如果他们还用交通灯。另外，所谓三原色，也是针对人而言的。</p>

<p>既然色彩只是种心理反应（感觉），那为了准确描述色彩和进行分析，就需要建立色彩模型。根据关注的角度不同，不同的研究者拿出了不同的色彩模型，例如孟塞尔颜色立体模型、CIE L* a* b* 模型。其中 CIE XYZ 模型应该是最能反映人的颜色视觉的，因为它的制定就是通过大量实验来测定人对三种特定波长光线S、M、L（约对应于红绿蓝）的刺激值X，Y，Z。实验方式是让人同时观察目标色光线和SML三组标准光的混合光，调节S/M/L的光强，使得人眼感觉混合光和目标色光线的颜色完全一样，从而得出目标色的XYZ值。CIE XYZ色彩空间是色彩管理的基础。</p>

<p>CIE XYZ定义了一个三维空间，展现起来不如二维图形直观。经常用来表示色彩空间大小的二维马蹄型图称为CIE xy色度图，如下图。它的纵横座标xy是根据XYZ推导出来的，x=X/(X+Y+Z), y=Y/(X+Y+Z), z=Z/(X+Y+Z), x+y+z=1。彩色的马蹄形范围表示人眼可见的全部色彩范围。在数码相机和电脑显示中使用的RGB色彩空间在CIE xy色度图中反映为三角形范围，三个顶点分别为R/G/B三原色。</p>

<p><img src="/attachments/2012/9/gamut.jpg" alt="" /></p>

<p>不考虑印刷，摄影爱好者一般会接触到的色彩空间也就是AdobeRGB和sRGB。从图中可见，AdobeRGB的色域比sRGB广，特别是在蓝绿色系方面，AdobeRGB能够表现的色彩比sRGB丰富很多。我查找不到资料描述各种数码相机的感光元件能够记录下来的色域有多大，但一般的说法是一般数码单反所能记录的色彩范围都比sRGB广，接近或大于AdobeRGB。因此，专业的摄影都会选择AdobeRGB色彩空间来保存图像文档。但问题是，我们的显示器并不能展现这么广的色域，民用型号通常都只能再现sRGB色彩空间或更小一点（广色域显示器会比sRGB大，但一般还是达不到AdobeRGB），因此照片中记录的部分颜色是无法在显示器上原汁原味的再现出来的（这里先不考虑显示器没有校准导致偏色问题），超出设备色彩空间的颜色只能用接近的来替换，例如翠绿色的海水就没有那么漂亮了。另外一个问题是有些软件，例如不是最新版本的浏览器，是不支持色彩管理的，它不会将照片的色彩空间映射到显示器的色彩空间以保持在可显示范围内的颜色一致，而是将照片中的RGB值当作设备色彩空间的值来直接显示。如果照片用的是sRGB还好，因为显示器本身大致符合sRGB，颜色偏差不会太多，但若照片是用色域更广的AdobeRGB的，色彩偏差就严重了。所以数码相机的说明书上一般会建议如果照片仅在电脑上观看最好选择sRGB。</p>

<p>不过，数码相机的色彩空间设置仅仅是针对JPG格式的，如果用RAW格式，保存的是传感器得到的原始值，实际上是数码相机设备色彩空间，而不是任何标准色彩空间。当在电脑中用RAW处理软件打开时，会将照片由设备色彩空间映射到软件设定的工作空间。我用Apple Aperture打开Nikon的RAW，看到它是被标识为AdobeRGB色彩空间。用数码单反的话，最好还是选择RAW格式，因为记录的信息多，后期处理的余地就大很多。</p>

<p>See also:</p>

<p><a href="/2004/11/12/Color-management-1">色彩管理(1)</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RAW照片后期处理的常用操作]]></title>
    <link href="http://aleung.github.io/blog/2011/09/27/RAW-/"/>
    <updated>2011-09-27T22:33:00+08:00</updated>
    <id>http://aleung.github.io/blog/2011/09/27/RAW-</id>
    <content type="html"><![CDATA[<p>这里讲的是 Apple Aperture 3 的操作，但其他RAW处理软件（如Photoshop Lightroom）的功能和效果也都类似，可以参考。</p>

<h2 id="exposure">Exposure</h2>

<h3 id="exposure-1">Exposure</h3>

<p>黑位固定，直方图右侧拉伸。相当于相机的曝光量调整。</p>

<p><img src="https://lh6.googleusercontent.com/-fnAGXvmnFJE/ToHQKWlruvI/AAAAAAAAAZ0/O4pdxnS64yY/s800/exposure-1.jpg" alt="" />》<img src="https://lh5.googleusercontent.com/-FP6Vg1nAOWI/ToHQKRFOhtI/AAAAAAAAAZ4/0lESY5sW318/s800/exposure-2.jpg" alt="" /></p>

<h3 id="recovery">Recovery</h3>

<p>利用RAW记录的额外信息恢复高光溢出部分。</p>

<h3 id="black-point">Black Point</h3>

<p>利用RAW记录的额外信息恢复丢失的暗部细节。</p>

<h3 id="brightness">Brightness</h3>

<p>黑位与白位均固定，直方图中间色调左右移动。用于调整图像的整体明暗。与level工具的亮度调节功能类似，但level工具中若只拖动一个锚点时对直方图的影响更加局部，只改变特定色调范围。</p>

<p><img src="https://lh5.googleusercontent.com/-mKyUGov3PCc/ToHQJ9LMS-I/AAAAAAAAAZs/Z7XqqxDgQJk/s800/brightness-1.jpg" alt="" />》<img src="https://lh4.googleusercontent.com/-MWAZLV47es8/ToHQKHGqVNI/AAAAAAAAAZw/B4GjHYLSF_A/s800/brightness-2.jpg" alt="" /></p>

<h2 id="enhance">Enhance</h2>

<h3 id="contrast">Contrast</h3>

<p>中灰不变，直方图向两侧拉伸。（不建议使用，用level工具控制更准确）</p>

<p><img src="https://lh6.googleusercontent.com/-lZY-AgmwRcU/ToHQJ3eBQMI/AAAAAAAAAZo/1lTWE0LHHoA/s800/contrast.jpg" alt="" /></p>

<h3 id="definition">Definition</h3>

<p>增强图像局部的对比度，但不影响整体图像的对比度，直方图无整体性变化。可提高图像明暗交界的细节，例如让云朵更加立体。</p>

<h3 id="saturation">Saturation</h3>

<p>让RGB三原色的直方图趋于重合或者更加离散。用于减弱色彩或者增强色彩(变鲜艳)。饱和度增加时图像细节会丢失。</p>

<p><img src="https://lh6.googleusercontent.com/-EKHur68d4-A/ToHQKvYuHQI/AAAAAAAAAZ8/LRPgisNijDM/s800/saturation-1.jpg" alt="" />》<img src="https://lh3.googleusercontent.com/-NGeEU2MWZwg/ToHQLOXNoBI/AAAAAAAAAaE/hwsr11w3eS0/s800/saturation-2.jpg" alt="" /></p>

<h3 id="vibrancy">Vibrancy</h3>

<p>与saturation类似，但不影响肤色。用于人像照片中的色彩调整，但保持肤色不变。</p>

<h2 id="highlights--shadows">Highlights &amp; Shadows</h2>

<p>降低高光部分亮度，但不影响中间调和暗部；提高暗部亮度，但不影响中间调和亮部。直方图上的效果是高光部分和/或暗部扩展，移向中间调位置，但实际处理并非单纯的直方图映射，运算时会考虑到周边像素的色调的影响。用于对图像中过亮或者过暗的部分进行补偿，增加色调变化细节。</p>

<h2 id="levels">Levels</h2>

<p>将直方图进行映射变换，下横轴是输入，上横轴是输出。Aperture的levels工具可以调节四分之一色调的映射，可以完成部分本来需要使用曲线工具的调节。</p>

<p>Levels调整是在上面几种调整的基础之上进行的，可能会抵消了前面所做的调整的效果。若非必要不应该将它与前面提到的工具混合使用。</p>

<p><img src="https://lh3.googleusercontent.com/-Af7kvdJq3pU/ToHQKit_TwI/AAAAAAAAAaA/1x5cdJ1hZrE/s800/level-1.jpg" alt="" />》<img src="https://lh3.googleusercontent.com/-f0jePRCWRAI/ToHQQCnp4qI/AAAAAAAAAaI/qW_bMiOvGZw/s800/level-2.jpg" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Apple Aperture 数码照片处理几板斧]]></title>
    <link href="http://aleung.github.io/blog/2011/09/27/Apple-Aperture-/"/>
    <updated>2011-09-27T22:04:00+08:00</updated>
    <id>http://aleung.github.io/blog/2011/09/27/Apple-Aperture-</id>
    <content type="html"><![CDATA[<p><img class="right" src="https://lh5.googleusercontent.com/-MGOVmxQlebs/ToHSOBbvsCI/AAAAAAAAAaQ/ZgUEHwlGelk/s800/aperture3.jpg"></p>

<p>以前都用Photoshop来处理照片，刚开始用Aperture，还真不太适应，用了几天兼阅读了help，慢慢有些了解了。对于照片的后期处理，其实用什么工具都大同小异，基本上就是几板斧。没拍好的照片也没有必要费心去调，直接删除就得了。</p>

<h2 id="raw">基本原则：使用RAW格式拍摄</h2>

<p>RAW记录了拍摄时的原始信息，而jpg是已经经过相机处理之后的图像。用RAW格式提供了后期处理的更多可能性，例如曝光的增减（当然是小范围内了），白平衡的重新设定。</p>

<h2 id="section">基本调整</h2>

<ul>
  <li><strong>图像倾斜矫正及裁剪</strong>：Viewer下方的工具栏有图标，或者用快捷键G和C。</li>
  <li><strong>色温校准</strong>：相机的自动百平衡经常不太准确，需要在White Balance设置正确色温，常见光源的色温表在<a href="http://good-good-study.appspot.com/blog/posts/152001">这儿</a>；另外用 Enhance － Tint 可以分别调节高光／中间调／暗部的偏色。</li>
  <li><strong>曝光调整</strong>：用快捷键Alt－Shift－H打开暗部与高光溢出显示，调节Exposure让图像曝光正常。Highlights &amp; Shadows可以挽救部分高光、暗部细节。如果要进一步调整，使用Enhance及Level。调整过程中，快捷键M可查看原始图像（Master）作对比。</li>
</ul>

<p>调整方法见<a href="http://good-good-study.appspot.com/blog/posts/153002">RAW照片后期处理的常用操作</a></p>

<h2 id="section-1">其他调整</h2>

<ul>
  <li><strong>色差纠正</strong>（消除紫边）：Chromatic Aberration</li>
  <li><strong>降噪</strong>：Noise Reduction</li>
  <li><strong>图像锐化</strong>：Edge Sharpen</li>
</ul>

<h2 id="section-2">常用快捷键</h2>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Function</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>V</td>
      <td>Switch view mode (browser / split view / viewer)</td>
    </tr>
    <tr>
      <td>I, H</td>
      <td>Show Inspector</td>
    </tr>
    <tr>
      <td>F</td>
      <td>Full screen</td>
    </tr>
    <tr>
      <td>W</td>
      <td>Switch Inspector tab (Library / Metadata / Adjustments)</td>
    </tr>
    <tr>
      <td>Y</td>
      <td>Show metadata</td>
    </tr>
    <tr>
      <td>T</td>
      <td>Show metadata tooltips</td>
    </tr>
    <tr>
      <td>M</td>
      <td>Show master image</td>
    </tr>
    <tr>
      <td>Z</td>
      <td>Zoom 100%</td>
    </tr>
    <tr>
      <td>`</td>
      <td>Loupe</td>
    </tr>
    <tr>
      <td>Alt-Shift-H</td>
      <td>Highlight hot &amp; cold areas</td>
    </tr>
    <tr>
      <td>Alt-F</td>
      <td>Show focus points</td>
    </tr>
    <tr>
      <td>0~5</td>
      <td>Rating</td>
    </tr>
  </tbody>
</table>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Color temperature of common light sources]]></title>
    <link href="http://aleung.github.io/blog/2011/09/27/Color-temperature-of-common-light-sources/"/>
    <updated>2011-09-27T19:28:00+08:00</updated>
    <id>http://aleung.github.io/blog/2011/09/27/Color-temperature-of-common-light-sources</id>
    <content type="html"><![CDATA[<p> </p>

<table>
  <thead>
    <tr>
      <th>Temperature</th>
      <th>Typical Sources</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1000K</td>
      <td><strong>Candles</strong>, oil lamps</td>
    </tr>
    <tr>
      <td>2000K</td>
      <td><strong>Very early sunrise</strong>, low effect tungsten lamps</td>
    </tr>
    <tr>
      <td>2500K</td>
      <td><strong>Household light bulbs</strong>(2680K - 40 W incandescent lamp)</td>
    </tr>
    <tr>
      <td>3000K</td>
      <td>Studio lights (continuous), 200 W incandescent lamp, (<strong>3200K - Sunrise/sunset;</strong><strong>3400K - 1 hour from dusk/dawn</strong>, Tungsten lamp)</td>
    </tr>
    <tr>
      <td>4000K</td>
      <td>Clear flashbulbs (now obsolete),<strong>Fluorescent</strong></td>
    </tr>
    <tr>
      <td>5000K</td>
      <td><strong>Typical average daylight</strong>, electronic flash</td>
    </tr>
    <tr>
      <td>5500K</td>
      <td>The sun at noon, (<strong>5500~6000K - vertical daylight</strong>)</td>
    </tr>
    <tr>
      <td>6000K</td>
      <td><strong>Bright sunshine with clear sky</strong></td>
    </tr>
    <tr>
      <td>7000K</td>
      <td><strong>Slightly overcast sky</strong></td>
    </tr>
    <tr>
      <td>8000K</td>
      <td><strong>Hazy sky</strong></td>
    </tr>
    <tr>
      <td>9000K</td>
      <td><strong>Open shade on clear day</strong></td>
    </tr>
    <tr>
      <td>10,000K</td>
      <td><strong>Heavily overcast sky</strong></td>
    </tr>
    <tr>
      <td>11,000K</td>
      <td><strong>Sunless blue skies</strong></td>
    </tr>
    <tr>
      <td>20,000+K</td>
      <td>Open shade in mountains on a really clear day</td>
    </tr>
  </tbody>
</table>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[照片的地理位置信息]]></title>
    <link href="http://aleung.github.io/blog/2006/06/17/Photographs-of-the-geographical-location-information/"/>
    <updated>2006-06-17T08:59:00+08:00</updated>
    <id>http://aleung.github.io/blog/2006/06/17/Photographs-of-the-geographical-location-information</id>
    <content type="html"><![CDATA[<p>在JPG图像的 EXIF meta data 中，有一组是与地理位置信息相关的，包括经纬度、高度、方向等，可以记录拍摄图像当时的位置信息。不过，目前内置GPS或者带有GPS接口的相机还非常少见，所以这组数据通常是空的。</p>

<p><a href="http://wwmx.org/">World-Wide Media eXchange</a> 提供了免费工具 WWMX Location Stamper，能够依照数码照片的拍摄时间将GPS记录的track的位置信息设置到照片的EXIF中。只要在拍摄的过程中同时打开GPS将track记录下来，通过这个软件处理，照片就能附加上坐标了。</p>

<p>照片添加了地理位置信息，日后的整理就会更加方便，不仅不会忘记照片是在什么地方拍的，而且以后一定会有软件能够根据坐标来管理照片，例如查找在某个区域拍摄的照片。</p>

<p>就目前而言，能够利用EXIF地理位置信息的软件还不多。<a href="http://www.opanda.com/cn/iexif/index.html">IExif</a>是一个EXIF查看工具，对于带有地理信息的照片可以在GoogleMap上面定位出拍摄地点。最新的Google Picasa Beta也增加了对geotag的支持，包括export到Google Earth，或者在Google Earth上给照片标注坐标。<a href="http://picasaweb.google.com/">Google Picasa Web Album</a> 开始公开测试了，相信Google一定会将旗下的GoogleMap，GoogleEarth，GooglePicasa集成在一起。</p>

<p>至于目前广泛使用的在线相册flickr，本身并不支持EXIF的地理信息，但是可以通过tag来记录照片的坐标，称为<a href="http://en.wikipedia.org/wiki/Geotag">geotag</a>。有大量的第三方网站和插件能够处理或使用geotag，通过geotag来聚合信息。<a href="http://www.flickr.com/groups/flickrimportr/">Flickr Importer</a> 可以在上传照片的时候根据EXIF自动创建geotag。也有少数第三方flickr服务能够直接使用EXIF地理信息，例如<a href="http://www.roblog.com/flickrfly-docs/">FlickrFly</a>。</p>

<p>我的<a href="http://www.flickr.com/photos/aleung/">flickr</a>里有一些照片已经标记上了，并且可以使用FlickrFly飞过去看看。</p>
]]></content>
  </entry>
  
</feed>

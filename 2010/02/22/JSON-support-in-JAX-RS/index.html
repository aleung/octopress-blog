
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JSON support in JAX-RS - Good good study, day day up</title>
  <meta name="author" content="Leo Liang">

  
  <meta name="description" content="JAX-RS is the Java API for RESTful web services. JSON is the most popular data binding of RESTful web service. In JAX-RS, Entity Providers supply &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aleung.github.com/blog/2010/02/22/JSON-support-in-JAX-RS/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="alternate" title="Good good study, day day up" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Good good study, day day up</a></h1>
  
    <h2>aleung的学习笔记, aleung的idea</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aleung.github.com/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">JSON Support in JAX-RS</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-22T23:33:00+08:00" pubdate data-updated="true">2010-02-22</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


<div class="entry-content"><p>JAX-RS is the Java API for RESTful web services. JSON is the most popular data binding of RESTful web service. In JAX-RS, Entity Providers supply mapping services between representations and their associated Java types. To support JSON representation, JSON provider is needed.</p>

<h2 id="json-support-in-jersey-and-cxf">JSON support in Jersey and CXF</h2>

<p>Both Jersey and Apache CXF support JSON data generated out of JAXB beans. Developer can generate JavatypefromXML schema (xsd) by JAXB ormanually write Java bean with annotations. Then the resource can support JSON representatons.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
</pre></td><td class="code"><pre><code class="java"><span class="line">   <span class="nd">@XmlRootElement</span>
</span><span class="line">   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">StatusInfoBean</span> <span class="o">{</span>
</span><span class="line">       <span class="kd">public</span> <span class="n">String</span> <span class="n">status</span> <span class="o">=</span> <span class="s">&quot;Idle&quot;</span><span class="o">;</span>
</span><span class="line">       <span class="kd">public</span> <span class="kt">int</span> <span class="n">tonerRemaining</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
</span><span class="line">       <span class="kd">public</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">JobInfoBean</span><span class="o">&gt;</span> <span class="n">jobs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">JobInfoBean</span><span class="o">&gt;();</span>
</span><span class="line">   <span class="o">}</span>
</span><span class="line">   <span class="nd">@Path</span><span class="o">(</span><span class="s">&quot;/status&quot;</span><span class="o">)</span>
</span><span class="line">   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyResource</span> <span class="o">{</span>
</span><span class="line">       <span class="n">StatusInfoBean</span> <span class="n">statusInfoBean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StatusInfoBean</span><span class="o">();</span>
</span><span class="line">       <span class="o">{{</span>
</span><span class="line">            <span class="n">statusInfoBean</span><span class="o">.</span><span class="na">jobs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JobInfoBean</span><span class="o">(</span><span class="s">&quot;sample.doc&quot;</span><span class="o">,</span> <span class="s">&quot;printing...&quot;</span><span class="o">,</span> <span class="mi">13</span><span class="o">));</span>
</span><span class="line">       <span class="o">}}</span>
</span><span class="line">
</span><span class="line">       <span class="nd">@GET</span>
</span><span class="line">       <span class="nd">@Produces</span><span class="o">(</span><span class="s">&quot;application/json&quot;</span><span class="o">)</span>
</span><span class="line">       <span class="kd">public</span> <span class="n">StatusInfoBean</span> <span class="nf">getStatus</span><span class="o">()</span> <span class="o">{</span>
</span><span class="line">           <span class="k">return</span> <span class="n">statusInfoBean</span><span class="o">;</span>
</span><span class="line">       <span class="o">}</span>
</span><span class="line">
</span><span class="line">       <span class="nd">@PUT</span>
</span><span class="line">       <span class="nd">@Consumes</span><span class="o">(</span><span class="s">&quot;application/json&quot;</span><span class="o">)</span>
</span><span class="line">       <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">setStatus</span><span class="o">(</span><span class="n">StatusInfoBean</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">           <span class="k">this</span><span class="o">.</span><span class="na">statusInfoBean</span> <span class="o">=</span> <span class="n">status</span><span class="o">;</span>
</span><span class="line">       <span class="o">}</span>
</span><span class="line">   <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="cusomize-the-json-provider">Cusomize the JSON provider</h2>

<p>The behavior of the JSON provider can be customized. But the way of customization is different in Jersey and CXF.</p>

<p>The configuration described in this article targets on Jersey 1.0.2 or higher, CXF 2.2 or higher.</p>

<p>In Jersey, developer should implement a JAXB ContextResolver which creates JSONJAXBContext with JSONConfiguration.Different configurations can be set bybuilder pattern.</p>

<pre><code>   @Provider
   public class MyJAXBContextResolver implements ContextResolver&lt;JAXBContext&gt; {

       private JAXBContext context;
       private Class[] types = {StatusInfoBean.class, JobInfoBean.class};

       public MyJAXBContextResolver() throws Exception {
           this.context = new JSONJAXBContext(
                   JSONConfiguration.mapped()
                                      .rootUnwrapping(true)
                                      .arrays("jobs")
                                      .nonStrings("pages", "tonerRemaining")
                                      .build(),
                   types);
       }

       public JAXBContext getContext(Class&lt;?&gt; objectType) {
           return (types[0].equals(objectType)) ? context : null;
       }
   }
</code></pre>

<p>Further simplificationway can be found in <a href="http://blogs.sun.com/japod/entry/configuring_json_for_restful_web">http://blogs.sun.com/japod/entry/configuring_json_for_restful_web</a></p>

<p>In Apache CXF, to customize the JSON provider, developer can implement a new provider or configure the properties of org.apache.cxf.jaxrs.provider.JSONProvider.</p>

<p>Custom provider is registered by Spring configuration:</p>

<pre><code>&lt;beans&gt;
&lt;jaxrs:server id="customerService" address="/"&gt;
    &lt;jaxrs:serviceBeans&gt;
      &lt;bean class="org.CustomerService" /&gt;
    &lt;/jaxrs:serviceBeans&gt;

    &lt;jaxrs:providers&gt;
      &lt;ref bean="jsonProvider" /&gt;
    &lt;/jaxrs:providers&gt;

    &lt;bean id="jsonProvider" class="org.apache.cxf.jaxrs.provider.JSONProvider"&gt;
      &lt;property name="dropRootName" value="true"/&gt;
      &lt;property name="serializeAsArray" value="true"/&gt;
      &lt;property name="arrayKeys" value="true"&gt;
        &lt;list&gt;&lt;value&gt;jobs&lt;/value&gt;&lt;/list&gt;
      &lt;/property&gt;
    &lt;/bean&gt;
&lt;/jaxrs:server&gt;
&lt;/beans&gt;
</code></pre>

<h3 id="drop-root-element--root-unwrapping">Drop root element / Root unwrapping</h3>

<p>Drop root element means strip out the root element from JSON. In the following example the StatusInfoBean element is dropped.</p>

<pre><code>{"status":"Idle","tonerRemaining":"25","jobs":{"name":"sample.doc","status":"printing...","pages":"13"}}
</code></pre>

<p>In Jersey whether dropping root element is configured by JSONConfiguration.rootUnwrapping(). In CXF it is by JSONProvider.setDropRootElement().</p>

<h3 id="single-value-array">Single value array</h3>

<p>Single value List object can be serialized as array or non-array. See example:</p>

<pre><code>{"rows":{"userid":"1621","name":"Grotefend"}}
{"rows":[{"userid":"1621","name":"Grotefend"}]}
</code></pre>

<p>In CXF it’s controlled by JSONProvider properties “serializeAsArray” and “arrayKeys”.</p>

<h3 id="namespace">Namespace</h3>

<p>If the JAXB bean has namespace, whether to include namespace in JSON can be controlled in CXF by JSONProvider properties “ignoreNamespaces”.</p>

<h2 id="nature-json-notation">Nature JSON notation</h2>

<p>Nature JSON notation is:</p>

<ul>
  <li>root unwrapping</li>
  <li>single value List object serialized as array</li>
  <li>???</li>
</ul>

<p>See com.sun.jersey.api.json.JSONConfiguration.Notation</p>
</div>


  <footer>
    <p class="meta">
    <!--
      
  

<span class="byline author vcard">Posted by <span class="fn">Leo Liang</span></span>

      








  


<time datetime="2010-02-22T23:33:00+08:00" pubdate data-updated="true">2010-02-22</time>
      


      

<span class="tags">
  
    <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


    -->
    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://aleung.github.com/blog/2010/02/22/JSON-support-in-JAX-RS/" data-via="acette" data-counturl="http://aleung.github.com/blog/2010/02/22/JSON-support-in-JAX-RS/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/02/14/This-blog-now-support-feed-output/" title="Previous Post: 这个blog现在支持feed输出了">&laquo; 这个blog现在支持feed输出了</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/02/24/Recommend-a-introduced-over-the-wall-knowledge-of-the-mailing-list/" title="Next Post: 推荐一个介绍翻墙知识的邮件列表">推荐一个介绍翻墙知识的邮件列表 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/06/24/try-octopress-markdown-features/">试验 Octopress 的各种特性</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/09/Some-reading-record/">一些读书记录</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/05/The-programmer-thought-of-uniting-the-reading-notes/">《程序员的思维修炼》读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/10/By-mobile-phone-remote-control-Linux-backstage-radio-broadcast-requirements/">用手机遥控Linux后台播放豆瓣电台</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/25/In-the-amazon-bought-the-computer-motherboard-and-summarizes-the-experience-of-fault-return/">在亚马逊买电脑主板，故障退货的经历及总结</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
<a style="font-size: 134%" href="/blog/tags/android/">Android</a>
<a style="font-size: 108%" href="/blog/tags/anti-gfw/">Anti-GFW</a>
<a style="font-size: 70%" href="/blog/tags/appserver/">AppServer</a>
<a style="font-size: 70%" href="/blog/tags/blogging/">Blogging</a>
<a style="font-size: 70%" href="/blog/tags/build/">Build</a>
<a style="font-size: 70%" href="/blog/tags/diy/">DIY</a>
<a style="font-size: 104%" href="/blog/tags/diy/">Diy</a>
<a style="font-size: 70%" href="/blog/tags/excel/">Excel</a>
<a style="font-size: 93%" href="/blog/tags/funny/">Funny</a>
<a style="font-size: 85%" href="/blog/tags/gps/">GPS</a>
<a style="font-size: 139%" href="/blog/tags/gps-gis/">GPS_GIS</a>
<a style="font-size: 70%" href="/blog/tags/geocaching/">Geocaching</a>
<a style="font-size: 70%" href="/blog/tags/http/">HTTP</a>
<a style="font-size: 144%" href="/blog/tags/idea/">Idea</a>
<a style="font-size: 99%" href="/blog/tags/imageprocessing/">ImageProcessing</a>
<a style="font-size: 70%" href="/blog/tags/learning/">Learning</a>
<a style="font-size: 108%" href="/blog/tags/life/">Life</a>
<a style="font-size: 85%" href="/blog/tags/maven/">Maven</a>
<a style="font-size: 146%" href="/blog/tags/misc/">Misc</a>
<a style="font-size: 85%" href="/blog/tags/novel/">Novel</a>
<a style="font-size: 70%" href="/blog/tags/outdoor/">Outdoor</a>
<a style="font-size: 85%" href="/blog/tags/personaldevelopment/">PersonalDevelopment</a>
<a style="font-size: 93%" href="/blog/tags/reading/">Reading</a>
<a style="font-size: 93%" href="/blog/tags/running/">Running</a>
<a style="font-size: 70%" href="/blog/tags/sip/">SIP</a>
<a style="font-size: 142%" href="/blog/tags/software/">Software</a>
<a style="font-size: 160%" href="/blog/tags/softwaredev/">SoftwareDev</a>
<a style="font-size: 99%" href="/blog/tags/sports/">Sports</a>
<a style="font-size: 85%" href="/blog/tags/spring/">Spring</a>
<a style="font-size: 119%" href="/blog/tags/sys-admin/">Sys_Admin</a>
<a style="font-size: 104%" href="/blog/tags/timemanagement/">TimeManagement</a>
<a style="font-size: 85%" href="/blog/tags/weblogic/">WebLogic</a>
<a style="font-size: 70%" href="/blog/tags/backup/">backup</a>
<a style="font-size: 93%" href="/blog/tags/idea/">idea</a>
<a style="font-size: 104%" href="/blog/tags/mobile/">mobile</a>
<a style="font-size: 70%" href="/blog/tags/wallpaper/">wallpaper</a>
<a style="font-size: 70%" href="/blog/tags/书摘/">书摘</a>
<a style="font-size: 70%" href="/blog/tags/交通/">交通</a>
<a style="font-size: 70%" href="/blog/tags/公民与社会/">公民与社会</a>
<a style="font-size: 70%" href="/blog/tags/家电/">家电</a>
<a style="font-size: 70%" href="/blog/tags/建筑/">建筑</a>
<a style="font-size: 70%" href="/blog/tags/文化艺术/">文化艺术</a>
<a style="font-size: 70%" href="/blog/tags/概率/">概率</a>
<a style="font-size: 70%" href="/blog/tags/环保/">环保</a>
<a style="font-size: 70%" href="/blog/tags/统计/">统计</a>
<a style="font-size: 70%" href="/blog/tags/阅读/">阅读</a>

  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Leo Liang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'aleung';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://aleung.github.com/blog/2010/02/22/JSON-support-in-JAX-RS/';
        var disqus_url = 'http://aleung.github.com/blog/2010/02/22/JSON-support-in-JAX-RS/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

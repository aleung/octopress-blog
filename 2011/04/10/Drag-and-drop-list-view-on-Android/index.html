
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Drag and drop list view on Android - Good good study, day day up</title>
  <meta name="author" content="Leo Liang">

  
  <meta name="description" content="I didn’t expect that implementing a drag and drop list view on Android is so difficult. It took me more than one week to get it work. Android SDK &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://aleung.github.io/blog/2011/04/10/Drag-and-drop-list-view-on-Android/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="alternate" title="Good good study, day day up" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2827715-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Good good study, day day up</a></h1>
  
    <h2>aleung的学习笔记, aleung的idea</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/GoodGoodStudyDayDayUp" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:aleung.github.io/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Drag and Drop List View on Android</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-10T06:05:00+08:00" pubdate data-updated="true">2011-04-10</time>
        
         | 

<span class="tags">
  
    <a class='tag' href='/blog/tags/android/'>Android</a>, <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


        
      </p>
    
  </header>


<div class="entry-content"><p>I didn’t expect that implementing a drag and drop list view on Android is so difficult. It took me more than one week to get it work.</p>

<p>Android SDK doesn’t provide too much support on drag and drop, at least there is no out of box API that can be used till Android 3.0 Honeycomb. It’s said that drag and drop support is improved in Android 3.0 SDK, I didn’t learn it yet because Android 3.0 hasn’t come to mobile device.</p>

<p>At first I looked for open source implementation of drag and drop list view. After searching on Internet I did find some examples and library, e.g. <a href="https://github.com/commonsguy/cwac-touchlist">CWAC TouchListView</a> , they all derives from source code of Android music application. However they don’t fit for my application: First, they require to specify the height of item view in code or in layout file, that also implicitly force all item views in the same height. In my application the list view has two item view types, which differ in height. Even if item views are in same height, I don’t like the way that specifying exact value of height, I perfer to set <code>layout_height</code> to <code>wrap_content</code> and let it automatically calculates the value. Second, by those implementation, on each list item view there must be a “grabber” element. User moves an item by putting finger on the grabber then drag. I want to keep UI of my application as clean as it can, I would like to active item dragging by long press on an item, instead of drag a grabber. So I implement my version of drag and drop list view, the source code is at GitHub: <a href="https://github.com/aleung/tasks365/blob/master/tasks365/src/leoliang/tasks365/DraggableListView.java">DraggableListView</a>. It isn’t perfect yet, still has large room for improvement.</p>

<p>A ListView shows items in a vertically scrolling list. The items can be refered by their position in the list. When there are a lot of items, only portion of them are visible. A visible item view can be retrieved by calling <code>ListView.getChildAt()</code>. Please be noticed that child view index is different to item position. In the code you will find these two values need to be converted between each other.</p>

<p><a href="http://www.flickr.com/photos/leoliang/5603506949/"><img src="http://farm6.static.flickr.com/5267/5603506949_627d31073c.jpg" alt="listview" /></a></p>

<p>Long press on an item is detected by<code>GestureDetector</code>, then a dragging object is created. The dragging object represents on UI by an ImageView, which is a copy of the view of the item to be moved. The dragging object moves on screen following user’s finger. Untill user’s finger leave touch screen, the list items do not change their order, they just expand or shrink to simulate item dragging.</p>

<p>In below diagram, dragging object is in green. Item at position 3 is being dragged in this example. When dragging starts, the view of item 3 shrinks its height to 1 to make it invisible (I didn’t investigate why height should be 1 instead of 0). User sees item 3 is dragged, actually it’s the dragging object – clone of the item 3 view. When dragging object is hovering at a position, the item view at that position expands to make an empty space, so looks like that it is being pushed aside by the dragging object.</p>

<p><a href="http://www.flickr.com/photos/leoliang/5604090272/"><img src="http://farm6.static.flickr.com/5101/5604090272_641594fa57_m.jpg" alt="listview-dnp-1" /></a><a href="http://www.flickr.com/photos/leoliang/5603507715/"><img src="http://farm6.static.flickr.com/5188/5603507715_d47cb49532_m.jpg" alt="listview-dnp-2" /></a></p>

<p>Here is a screenshot of demo:</p>

<p><a href="http://www.flickr.com/photos/leoliang/5603811095/"><img src="http://farm5.static.flickr.com/4099/5603811095_f2f7c52c79.jpg" alt="DraggableListView" /></a></p>
</div>


  <footer>
    <p class="meta">
    <!--
      
  

<span class="byline author vcard">Posted by <span class="fn">Leo Liang</span></span>

      








  


<time datetime="2011-04-10T06:05:00+08:00" pubdate data-updated="true">2011-04-10</time>
      


      

<span class="tags">
  
    <a class='tag' href='/blog/tags/android/'>Android</a>, <a class='tag' href='/blog/tags/softwaredev/'>SoftwareDev</a>
  
</span>


    -->
    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://aleung.github.io/blog/2011/04/10/Drag-and-drop-list-view-on-Android/" data-via="" data-counturl="http://aleung.github.io/blog/2011/04/10/Drag-and-drop-list-view-on-Android/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/03/24/My-task-management-tools-function-prototype-has-been-completed/" title="Previous Post: 我的任务管理工具功能原型已经完成">&laquo; 我的任务管理工具功能原型已经完成</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/06/26/Determine-priority/" title="Next Post: 确定优先级">确定优先级 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Note</h1>
  <p>中国大陆用户可能会因为网络被屏蔽而无法访问本网站或部分内容(文字/图片), 如遇到这种情况, 请翻墙访问</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/23/plantuml/">PlantUML</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/23/getting-the-hang-of-web-typography/">Getting the Hang of Web Typography</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/21/run/">跑步日記</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/03/zhong-guo-di-tu-pian-yi/">中國電子地圖偏移</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/15/pebble/">Pebble</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
<a style="font-size: 139%" href="/blog/tags/android/">Android</a>
<a style="font-size: 113%" href="/blog/tags/anti-gfw/">Anti-GFW</a>
<a style="font-size: 93%" href="/blog/tags/appserver/">AppServer</a>
<a style="font-size: 99%" href="/blog/tags/architecture/">Architecture</a>
<a style="font-size: 70%" href="/blog/tags/artculture/">ArtCulture</a>
<a style="font-size: 115%" href="/blog/tags/blogging/">Blogging</a>
<a style="font-size: 113%" href="/blog/tags/civilsociety/">CivilSociety</a>
<a style="font-size: 110%" href="/blog/tags/diy/">DIY</a>
<a style="font-size: 70%" href="/blog/tags/datavisualization/">DataVisualization</a>
<a style="font-size: 70%" href="/blog/tags/database/">Database</a>
<a style="font-size: 84%" href="/blog/tags/design/">Design</a>
<a style="font-size: 70%" href="/blog/tags/environmentalprotection/">EnvironmentalProtection</a>
<a style="font-size: 70%" href="/blog/tags/excel/">Excel</a>
<a style="font-size: 84%" href="/blog/tags/funny/">Funny</a>
<a style="font-size: 143%" href="/blog/tags/gps-gis/">GPS_GIS</a>
<a style="font-size: 84%" href="/blog/tags/gadget/">Gadget</a>
<a style="font-size: 70%" href="/blog/tags/geek/">Geek</a>
<a style="font-size: 70%" href="/blog/tags/geocaching/">Geocaching</a>
<a style="font-size: 70%" href="/blog/tags/hardware/">Hardware</a>
<a style="font-size: 70%" href="/blog/tags/homeappliance/">HomeAppliance</a>
<a style="font-size: 139%" href="/blog/tags/idea/">Idea</a>
<a style="font-size: 110%" href="/blog/tags/imageprocessing/">ImageProcessing</a>
<a style="font-size: 93%" href="/blog/tags/java/">Java</a>
<a style="font-size: 70%" href="/blog/tags/learning/">Learning</a>
<a style="font-size: 110%" href="/blog/tags/life/">Life</a>
<a style="font-size: 103%" href="/blog/tags/maven/">Maven</a>
<a style="font-size: 138%" href="/blog/tags/misc/">Misc</a>
<a style="font-size: 107%" href="/blog/tags/mywork/">MyWork</a>
<a style="font-size: 84%" href="/blog/tags/novel/">Novel</a>
<a style="font-size: 84%" href="/blog/tags/outdoor/">Outdoor</a>
<a style="font-size: 103%" href="/blog/tags/personaldevelopment/">PersonalDevelopment</a>
<a style="font-size: 70%" href="/blog/tags/r/">R</a>
<a style="font-size: 119%" href="/blog/tags/reading/">Reading</a>
<a style="font-size: 124%" href="/blog/tags/running/">Running</a>
<a style="font-size: 70%" href="/blog/tags/sip/">SIP</a>
<a style="font-size: 135%" href="/blog/tags/software/">Software</a>
<a style="font-size: 160%" href="/blog/tags/softwaredev/">SoftwareDev</a>
<a style="font-size: 93%" href="/blog/tags/springframework/">SpringFramework</a>
<a style="font-size: 84%" href="/blog/tags/statistics/">Statistics</a>
<a style="font-size: 124%" href="/blog/tags/sysadmin/">SysAdmin</a>
<a style="font-size: 119%" href="/blog/tags/timemanagement/">TimeManagement</a>
<a style="font-size: 84%" href="/blog/tags/uml/">UML</a>
<a style="font-size: 99%" href="/blog/tags/ux/">UX</a>
<a style="font-size: 107%" href="/blog/tags/web/">Web</a>
<a style="font-size: 99%" href="/blog/tags/weblogic/">WebLogic</a>
<a style="font-size: 70%" href="/blog/tags/i18n/">i18n</a>

  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Leo Liang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'aleung';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://aleung.github.io/blog/2011/04/10/Drag-and-drop-list-view-on-Android/';
        var disqus_url = 'http://aleung.github.io/blog/2011/04/10/Drag-and-drop-list-view-on-Android/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
